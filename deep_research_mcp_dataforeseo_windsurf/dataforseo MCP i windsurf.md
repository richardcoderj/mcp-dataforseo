Perfekt, tack f√∂r klarg√∂randet! Jag s√§tter ig√•ng med att ta fram en fullst√§ndig guide f√∂r att bygga en MCP-server som anv√§nder DataForSEO API, anpassad f√∂r Windsurf och GitHub Copilot Agents i VSCode.

Jag kommer att inkludera:
- Hur man bygger en MCP-server steg f√∂r steg
- J√§mf√∂relse mellan Python och JavaScript (vad som √§r enklast och b√§st)
- Rekommendation om hosting (lokalt vs VPS)
- Specifika krav fr√•n Windsurf och Copilot Agents
- Vanliga fel och hur man undviker dem

Jag meddelar dig s√• snart allt √§r klart!

# Guide: Bygga en MCP-server med DataForSEO API (f√∂r Windsurf & GitHub Copilot Agents)

*En Multi-Command Provider (MCP) server l√•ter AI-verktyg som Windsurf och GitHub Copilot Agents anropa externa tj√§nster. I denna guide bygger vi en egen MCP-server som kopplar upp mot DataForSEO:s API f√∂r SEO-data. Guiden t√§cker steg-f√∂r-steg hur du implementerar servern, val av programmeringsspr√•k (Python vs JavaScript), rekommendationer kring hosting (lokalt vs VPS), krav fr√•n Windsurf/Copilot Agents samt vanliga fallgropar och l√∂sningar.* ([Anthropic Publishes Model Context Protocol Specification for LLM App Integration - InfoQ](https://www.infoq.com/news/2024/12/anthropic-model-context-protocol/#:~:text=Anthropic%20recently%20released%20their%20Model,of%20reference%20implementations%20of%20MCP))

## Steg-f√∂r-steg: Bygga MCP-servern med DataForSEO

1. **F√∂rbered API-√•tkomst och milj√∂:** Skaffa **DataForSEO**-inloggningsuppgifter (API-login och l√∂senord) fr√•n ditt konto. Spara dem som milj√∂variabler (t.ex. `DATAFORSEO_LOGIN` och `DATAFORSEO_PASSWORD`) f√∂r att undvika att h√•rdkoda k√§nsliga uppgifter. Se till att din utvecklingsmilj√∂ har n√∂dv√§ndiga verktyg:
   - **Python:** Installera Python 3 och l√§gg till det officiella MCP Python SDK:t med `pip install "mcp[cli]"` ([GitHub - modelcontextprotocol/python-sdk: The official Python SDK for Model Context Protocol servers and clients](https://github.com/modelcontextprotocol/python-sdk#:~:text=Then%20add%20MCP%20to%20your,project%20dependencies)). Detta SDK f√∂renklar implementeringen av MCP-servern avsev√§rt, med f√§rdiga transportlager (STDIO, SSE) och dekoratorer f√∂r att definiera verktyg ([GitHub - modelcontextprotocol/python-sdk: The official Python SDK for Model Context Protocol servers and clients](https://github.com/modelcontextprotocol/python-sdk#:~:text=,return%20a%20%2B%20b)).
   - **JavaScript/TypeScript:** Installera Node.js (v18+). Skapa ett nytt Node-projekt (`npm init -y`) och installera n√∂dv√§ndiga paket. Du kan anv√§nda en community-implementation f√∂r DataForSEO (t.ex. `npm install @skobyn/mcp-dataforseo`) ([GitHub - Skobyn/mcp-dataforseo: Model Context Protocol server for DataForSEO API](https://github.com/skobyn/mcp-dataforseo#:~:text=You%20can%20run%20directly%20with,npx)), eller skriva egen kod med Node:s standardbibliotek eller ett ramverk.

2. **Skapa MCP-serverns struktur:** En MCP-server exponerar *verktyg* (‚Äútools‚Äù) ‚Äì funktioner som AI-agenten kan kalla ‚Äì via JSON med MCP-protokollet ([GitHub - modelcontextprotocol/python-sdk: The official Python SDK for Model Context Protocol servers and clients](https://github.com/modelcontextprotocol/python-sdk#:~:text=The%20Model%20Context%20Protocol%20,MCP%20servers%20can)). I koden beh√∂ver du:
   - **Initiera servern:** ge servern ett namn och starta transporten. (Med Python SDK kan du anv√§nda `FastMCP("DataForSEO")` f√∂r att skapa serverobjektet ([GitHub - modelcontextprotocol/python-sdk: The official Python SDK for Model Context Protocol servers and clients](https://github.com/modelcontextprotocol/python-sdk#:~:text=,Demo)). I Node/JS kan du starta en process som l√§ser STDIN och skriver STDOUT, eller k√∂ra en SSE-webbserver.)
   - **Definiera verktygen:** F√∂r varje typ av API-anrop du vill exponera, definiera en funktion. I Python g√∂rs detta enkelt med dekoratorn `@mcp.tool()` ([GitHub - modelcontextprotocol/python-sdk: The official Python SDK for Model Context Protocol servers and clients](https://github.com/modelcontextprotocol/python-sdk#:~:text=,return%20a%20%2B%20b)), medan du i Node kan definiera en hanterare baserat p√• ett f√§lt i inkommande JSON (`"type": "...")` ([GitHub - Skobyn/mcp-dataforseo: Model Context Protocol server for DataForSEO API](https://github.com/skobyn/mcp-dataforseo#:~:text=echo%20%27%7B,config%20%27%7B%22username%22%3A%22your_username%22%2C%22password%22%3A%22your_password)) ([GitHub - Skobyn/mcp-dataforseo: Model Context Protocol server for DataForSEO API](https://github.com/skobyn/mcp-dataforseo#:~:text=SERP%20API)). Till exempel kan vi skapa ett verktyg f√∂r att h√§mta s√∂kvolym p√• nyckelord:
     ```python
     import os, requests
     from mcp.server.fastmcp import FastMCP

     mcp = FastMCP("DataForSEO")
     @mcp.tool()
     def get_search_volume(keywords: list[str], location_code: int = 2840, language_code: str = "en") -> dict:
         """H√§mtar Google Ads-s√∂kvolym f√∂r en lista av nyckelord."""
         username = os.environ["DATAFORSEO_LOGIN"]; password = os.environ["DATAFORSEO_PASSWORD"]
         payload = {
             "keywords": keywords,
             "location_code": location_code,
             "language_code": language_code,
             "device": "desktop"
         }
         resp = requests.post(
             "https://api.dataforseo.com/v3/keywords_data/google_ads/search_volume/live",
             auth=(username, password), json=payload
         )
         return resp.json()
     ```
     I exemplet ovan anropas DataForSEO:s **Keyword Data API** f√∂r s√∂kvolym genom en HTTPS-POST (med Basic Auth inneh√•llande login och l√∂senord i headern ([A Kickstart Guide to Using DataForSEO APIs ‚Äì DataForSEO](https://dataforseo.com/blog/a-kickstart-guide-to-using-dataforseo-apis#:~:text=2%20Regardless%20of%20the%20programming,request%20in%20the%20following%20format))). Funktionen returnerar API:ets JSON-svar direkt. P√• liknande s√§tt kan du l√§gga till verktyg f√∂r SERP-data, backlink-analys m.m. Genom att dokumentera funktionen (docstring) beskriver du verktygets syfte ‚Äì denna beskrivning kan visas i AI-agentens verktygslista.

3. **Starta och testa servern lokalt:** K√∂r din MCP-server lokalt f√∂r att s√§kerst√§lla att den fungerar innan integrering i IDE:
   - **Python:** Starta servern via SDK: `mcp dev server.py` (om du anv√§nder `FastMCP`) vilket k√∂r servern i utvecklingsl√§ge. Alternativt kan du k√∂ra ditt Python-script direkt ‚Äì SDK:n lyssnar d√• p√• STDIN/SSE beroende p√• konfiguration.
   - **Node:** Om du anv√§nder en paketerad server (t.ex. skobyns paket) kan du k√∂ra `npx @skobyn/mcp-dataforseo --config '{"username":"...","password":"..."}'` f√∂r att testa ett enkelt anrop ([GitHub - Skobyn/mcp-dataforseo: Model Context Protocol server for DataForSEO API](https://github.com/skobyn/mcp-dataforseo#:~:text=You%20can%20run%20directly%20with,npx)) ([GitHub - Skobyn/mcp-dataforseo: Model Context Protocol server for DataForSEO API](https://github.com/skobyn/mcp-dataforseo#:~:text=Send%20JSON%20requests%20to%20stdin,receive%20JSON%20responses%20from%20stdout)). Om du skrivit egen Node-kod, starta den (`node server.js`) och skicka in ett JSON-kommando via terminalen f√∂r att verifiera responsen:
     ```bash
     echo '{"type": "dataforseo_keywords_data", "keywords": ["example"], "location_code": 2840, "language_code": "en"}' | node server.js 
     ```
     Du b√∂r f√• ett JSON-svar p√• stdout med data (eller felmeddelande) fr√•n DataForSEO. Kontrollera att API-nycklarna fungerar (API-svaret kan inneh√•lla `status_message` och `status_code` som bekr√§ftar om anropet lyckades ([A Kickstart Guide to Using DataForSEO APIs ‚Äì DataForSEO](https://dataforseo.com/blog/a-kickstart-guide-to-using-dataforseo-apis#:~:text=Alongside%20general%20HTTP%20status%20codes%2C,g))).

4. **Konfigurera MCP-servern i Windsurf och/eller VS Code:** N√§r servern √§r testad l√§gger du till den i din AI-utvecklingsmilj√∂:
   - **Windsurf (Cascade):** G√• till *Settings > Cascade (MCP)* i Windsurf och v√§lj ‚ÄúAdd custom server +‚Äù. Ange kommando och argument f√∂r att starta servern. Windsurf st√∂djer b√•de STDIO (lokal process) och SSE (HTTP) transporter ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=Windsurf%20supports%20two%20transport%20types,sse)). F√∂r en lokal Node-server anger du t.ex:
     ```json
     {
       "mcpServers": {
         "seo-tools": {
           "command": "npx",
           "args": ["@skobyn/mcp-dataforseo"],
           "env": {
             "DATAFORSEO_LOGIN": "<DIN_LOGIN>",
             "DATAFORSEO_PASSWORD": "<DITT_L\u00D6SENORD>"
           }
         }
       }
     }
     ``` 
     I ovan config startar Windsurf din server via `npx` och injectar milj√∂variablerna med API-uppgifter ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=%7B%20%22mcpServers%22%3A%20%7B%20%22google,maps%22%20%5D%2C%20%22env%22%3A)). Efter att du sparat konfigurationen, klicka p√• **Refresh**-knappen i MCP-inst√§llningarna f√∂r att ladda in verktygen ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=Make%20sure%20to%20press%20the,add%20a%20new%20MCP%20server)). Serverns tillg√§ngliga verktyg b√∂r nu visas under ‚ÄúAvailable Tools‚Äù i Windsurf; om de inte syns, kontrollera s√∂kv√§gar och f√∂rs√∂k igen ([GitHub - yeakub108/mcp-server: MCP Server for Windsurf](https://github.com/yeakub108/mcp-server#:~:text=,js%20file)).
   - **VS Code (GitHub Copilot Agents):** Skapa filen `.vscode/mcp.json` i ditt projekt (eller l√§gg till i VS¬†Code settings) med MCP-konfiguration. Exempel:
     ```json
     {
       "servers": {
         "seo-tools": {
           "command": "uvx",
           "args": ["mcp-dataforseo"]
         }
       },
       "inputs": [
         { "type": "promptString" }
       ]
     }
     ```
     H√§r anv√§nder `uvx` (en verktygsk√∂rningsmotor i MCP-ekosystemet) f√∂r att starta servern. `"inputs": [{ "type": "promptString" }]` kan anv√§ndas om servern beh√∂ver interaktiv inmatning (t.ex. om du vill att VS¬†Code ska fr√•ga efter l√∂senord vid start) ([Extending Copilot Chat with the Model Context Protocol (MCP) - GitHub Docs](https://docs.github.com/en/copilot/customizing-copilot/extending-copilot-chat-with-mcp#:~:text=%7B%20,)) ([Extending Copilot Chat with the Model Context Protocol (MCP) - GitHub Docs](https://docs.github.com/en/copilot/customizing-copilot/extending-copilot-chat-with-mcp#:~:text=,fetch%22%5D%20%7D%20%7D)). Spara filen och klicka p√• **Start**-knappen som visas ovanf√∂r serverlistan i VS¬†Code f√∂r att initiera servern ([Extending Copilot Chat with the Model Context Protocol (MCP) - GitHub Docs](https://docs.github.com/en/copilot/customizing-copilot/extending-copilot-chat-with-mcp#:~:text=3.%20A%20,then%20stored%20for%20later%20sessions)). √ñppna Copilot Chat-panelen, v√§xla till **Agent**-l√§ge, och klicka p√• verktygsikonen f√∂r att se att din server och dess verktyg har laddats ([Extending Copilot Chat with the Model Context Protocol (MCP) - GitHub Docs](https://docs.github.com/en/copilot/customizing-copilot/extending-copilot-chat-with-mcp#:~:text=Image%3A%20Screenshot%20of%20the%20Copilot,is%20outlined%20in%20dark%20orange)).

5. **Anv√§nd MCP-verktygen via AI-agenten:** Nu kan du anv√§nda DataForSEO-verktygen i dina kodassistentsessioner. Be agenten att utf√∂ra SEO-relaterade kommandon, t.ex.: *‚ÄúH√§mta s√∂kvolymen f√∂r \`Node.js tutorial\`‚Äù* eller *‚ÄúAnalysera backlink-profiler f√∂r example.com‚Äù*. AI-agenten kommer att identifiera att detta kr√§ver DataForSEO-verktyg och be om till√•telse att k√∂ra dem. **Observera:** Du m√•ste vanligtvis godk√§nna verktygsanropet f√∂rsta g√•ngen det sker, f√∂r s√§kerhets skull ([GitHub - yeakub108/mcp-server: MCP Server for Windsurf](https://github.com/yeakub108/mcp-server#:~:text=%2A%20,Read%20multiple%20files)). Efter godk√§nnande k√∂r agenten verktyget, MCP-servern anropar DataForSEO API i bakgrunden, och resultatet returneras i chatten. Exempel p√• svar kan vara en sammanfattning av s√∂kvolymer eller topplistan av organiska s√∂kresultat, beroende p√• vilket verktyg som anv√§nts.

## J√§mf√∂relse: Python vs JavaScript f√∂r MCP-utveckling

B√•de **Python** och **JavaScript/TypeScript** √§r popul√§ra val f√∂r att bygga en MCP-server, men de erbjuder olika f√∂rdelar:

- **Python:** Rekommenderas f√∂r snabb prototypning och enkelhet. Anthropic erbjuder ett officiellt Python SDK f√∂r MCP ([Anthropic Publishes Model Context Protocol Specification for LLM App Integration - InfoQ](https://www.infoq.com/news/2024/12/anthropic-model-context-protocol/#:~:text=The%20MCP%20is%20intended%20to,According%20to%20Anthropic)) som hanterar mycket av infrastrukturen (transport, JSON-RPC-protokoll etc.) √•t dig. Med dekorator-baserade funktioner (`@mcp.tool`, `@mcp.resource`) kan du definiera MCP-verktyg med minimal kod ([GitHub - modelcontextprotocol/python-sdk: The official Python SDK for Model Context Protocol servers and clients](https://github.com/modelcontextprotocol/python-sdk#:~:text=,return%20a%20%2B%20b)). Python har ocks√• kraftfulla HTTP-bibliotek (`requests`, `httpx`) vilket underl√§ttar integrering mot DataForSEO. Om du f√∂redrar Python kan du dra nytta av tydlig syntax och ett stort ekosystem av databehandling- och JSON-hanteringsbibliotek. Nackdelen kan vara prestanda ‚Äì Python √§r inte lika snabb som Node.js n√§r det g√§ller parallell hantering av m√•nga simultana f√∂rfr√•gningar, men f√∂r de flesta MCP-√§ndam√•l (som oftast √§r I/O-bundna API-anrop) √§r detta s√§llan ett problem.

- **JavaScript/TypeScript:** Passar bra om du redan arbetar mycket i Node.js-milj√∂ eller vill ha stark typkontroll med TypeScript. MCP-specifikationen √§r ursprungligen definierad i TypeScript, och det finns en officiell referensimplementation i TS ([Anthropic Publishes Model Context Protocol Specification for LLM App Integration - InfoQ](https://www.infoq.com/news/2024/12/anthropic-model-context-protocol/#:~:text=The%20MCP%20is%20intended%20to,According%20to%20Anthropic)). Communityn har tagit fram flera f√§rdiga MCP-servrar i Node ‚Äì t.ex. en komplett DataForSEO MCP-server skriven i TypeScript finns √∂ppen k√§llkod ([DataForSEO MCP server for AI agents](https://playbooks.com/mcp/skobyn-dataforseo-seo#:~:text=Language)). Att anv√§nda Node inneb√§r att du kan publicera din MCP-server som ett NPM-paket och enkelt dela den. Node √§r ocks√• v√§l l√§mpat f√∂r SSE (Server-Sent Events) om du planerar att k√∂ra servern p√• en extern server. √Ö andra sidan kan den initiala implementeringen kr√§va lite mer grundarbete √§n i Python (om du inte anv√§nder en f√§rdig mall), eftersom du beh√∂ver s√§tta upp STDIN/SSE-hantering sj√§lv eller med hj√§lp av ett ramverk. F√∂r HTTP-anrop till DataForSEO finns utm√§rkta bibliotek som `axios` eller inbyggda `fetch`/`https` moduler att anv√§nda. 

**Vad √§r enklast och b√§st?** Det beror p√• din bakgrund och m√•l. Python med MCP SDK √§r sannolikt **enklast att komma ig√•ng med** ‚Äì ‚Äúl√∂dkolvsfritt‚Äù d√• mycket √§r abstraherat, vilket *Kenny Vaneetvelde* (skaparen av Atomic Agents) p√•pekar: att skapa en MCP-server √§r **l√∂jligt enkelt** med Python SDK:t. JavaScript/TypeScript √§r d√§remot **b√§st l√§mpat** om du vill integrera i en Node-baserad stack eller bidra till det v√§xande TS-baserade MCP-ekosystemet. B√•da spr√•ken kan uppn√• samma funktionalitet ‚Äì i praktiken kan valet kokas ned till vilket ekosystem du √§r mest bekv√§m med och om du v√§rdes√§tter Pythons enkelhet framf√∂r TypeScripts struktur. M√•nga utvecklare v√§ljer Python f√∂r prototyper och byter till en TypeScript-implementation f√∂r produktion n√§r kraven p√• struktur och paketering √∂kar. 

*(Notera: Det finns √§ven MCP-implementationer i andra spr√•k, t.ex. C#/.NET, men Python och Node √§r de mest st√∂dda/plattformsoberoende vid skrivande stund.)*

## Rekommendation: K√∂ra servern lokalt eller p√• en VPS?

En MCP-server kan antingen k√∂ras **lokalt p√• din dator** (t.ex. startas av editorn) eller **p√• en extern server (VPS/cloud)** som du ansluter till via n√§tverk (SSE). B√•da alternativen har f√∂r- och nackdelar:

- **Lokal drift (p√• utvecklingsdatorn):** Detta inneb√§r att MCP-servern startas som en subprocess av editorn (STDIO-transport). F√∂rdelar inkluderar l√•g **latens** (ingen n√§tverksf√∂rdr√∂jning ‚Äì allt sker internt) och enkel **√•tkomst till lokala resurser** (om verktygen beh√∂ver l√§sa filer eller interagera med lokala program). Dessutom slipper du exponera servern √∂ver internet, vilket minskar attackytan. Lokal drift passar bra under utveckling och f√∂r personligt bruk. Nackdelar √§r att servern bara √§r ig√•ng n√§r din editor/dator √§r ig√•ng, samt potentiella **s√§kerhetsrisker** ‚Äì att k√∂ra ok√§nda MCP-servrar lokalt kan vara farligt om de k√∂r illasinnad kod ([Which MCP Server Transport is Better? Comparing STDIO and SSE : r/modelcontextprotocol](https://www.reddit.com/r/modelcontextprotocol/comments/1k0doby/which_mcp_server_transport_is_better_comparing/#:~:text=especially%20given%20current%20MCP%20Host,risks%20that%20can%27t%20be%20ignored)). Eftersom du i detta fall litar p√• din egen kod √§r det mindre orosmoment, men kom ih√•g att MCP-verktyg har tillg√•ng till din milj√∂ med samma r√§ttigheter som du har. Om du utvecklar i t.ex. VS Code, s√• √§r lokal STDIO oftast standardvalet (via `uvx` eller direkt kommandok√∂rning i konfigurationen).

- **VPS/Extern drift (cloud/server):** H√§r k√∂rs MCP-servern som en frist√•ende tj√§nst p√• t.ex. en molnserver. Editorn kopplar upp via **HTTP SSE**-transport (genom att ange serverns URL, t.ex. `https://din-server.com/sse` ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=Windsurf%20supports%20two%20transport%20types,sse))). F√∂rdelar: Servern kan **vara ig√•ng dygnet runt**, oberoende av din egen dator ‚Äì bra f√∂r team som vill dela p√• en MCP-tj√§nst eller om du vill utnyttja en servers prestanda. Det √§r ocks√• mer **skalbart och s√§kert** p√• sikt; SSE √∂ver HTTPS inneb√§r att kommunikationen √§r krypterad och kan enklare begr√§nsas/brandv√§ggas. Faktum √§r att SSE (HTTP streaming) generellt rekommenderas som framtidens v√§g f√∂r MCP p.g.a. b√§ttre s√§kerhet och skalbarhet ([Which MCP Server Transport is Better? Comparing STDIO and SSE : r/modelcontextprotocol](https://www.reddit.com/r/modelcontextprotocol/comments/1k0doby/which_mcp_server_transport_is_better_comparing/#:~:text=SSE%20offers%20a%20more%20secure,the%20preferred%20option%20moving%20forward)). Nackdelar: **Latency** √∂kar n√•got (data ska √∂ver n√§tverket), s√• snabba verktygsanrop kan bli n√•gra hundra millisekunder l√•ngsammare. Du m√•ste hantera **hostingkostnad och underh√•ll** av servern (uppdateringar, uptime, loggning). Dessutom kr√§vs att du s√§krar servern ‚Äì minst via API-nyckel eller annan autentisering om den √§r publikt n√•bar, s√• att inte vem som helst kan ansluta. Lyckligtvis st√∂der MCP-protokollet inbyggt att klienten f√∂rst skickar n√•gon form av autentisering eller att du kan implementera en simpel token-check i din SSE endpoint. I praktiken kan du ocks√• h√•lla SSE-servern privat inom ett VPN eller med IP-begr√§nsning om den bara ska anv√§ndas av dig sj√§lv. 

**Rekommendation:** F√∂r b√∂rja‚Äì anv√§nd *lokal drift* under utveckling eftersom det √§r enklare att debugga. N√§r allt fungerar, √∂verv√§g om du beh√∂ver st√§ndig √•tkomst eller delning ‚Äì d√• kan du migrera till en VPS med SSE. Om du k√∂r tung datah√§mtning via DataForSEO (som kan generera stora svar) kan en server med b√§ttre bandbredd och prestanda ge f√∂rdelar. T√§nk ocks√• p√• att DataForSEO API-anrop drar krediter oavsett var servern k√∂rs; en f√∂rdel med en central server kan vara att implementera caching av vanliga fr√•gor f√∂r att spara p√• API-kvotan. Sammanfattningsvis: **lokalt** √§r b√§st f√∂r enkelhet och l√§gsta latency f√∂r en enskild utvecklare, medan **VPS** √§r b√§st f√∂r robusthet, delning och s√§ker produktion **(SSE rekommenderas d√•)** ([Which MCP Server Transport is Better? Comparing STDIO and SSE : r/modelcontextprotocol](https://www.reddit.com/r/modelcontextprotocol/comments/1k0doby/which_mcp_server_transport_is_better_comparing/#:~:text=SSE%20offers%20a%20more%20secure,the%20preferred%20option%20moving%20forward)).

## Krav fr√•n Windsurf & Copilot Agents p√• MCP-servrar

B√•de Windsurf (Codeium Cascade) och GitHub Copilot Agents (VS¬†Code) f√∂ljer MCP-standarden, men det finns praktiska krav att k√§nna till f√∂r att din server ska fungera smidigt:

- **Transport och endpoints:** Som n√§mnt st√∂ds tv√• transportl√§gen ‚Äì STDIO och SSE. En **STDIO-server** startas av klienten (editorn) via ett kommando. H√§r f√∂rv√§ntas servern kommunicera via standard in/ut (stdin/stdout) med JSON-meddelanden. En **SSE-server** ska exponera en HTTP-endpoint p√• `/sse` f√∂r att klienten ska kunna ansluta ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=Windsurf%20supports%20two%20transport%20types,sse)). I SSE-l√§get h√•ller klienten en l√•nglivad HTTP-anslutning (event stream) d√§r servern skickar data. Se till att SSE-endpointen svarar med korrekt content-type (`text/event-stream`) och hanterar eventuella sessioner enligt MCP-specifikationen. De flesta ramverk (t.ex. Starlette/FastAPI f√∂r Python eller Express + `eventsource`-middleware f√∂r Node) har st√∂d f√∂r SSE. *Tips:* Kontrollera att din Windsurf/VSCode-konfiguration matchar servertypen ‚Äì om du anger en URL kommer klienten f√∂rs√∂ka SSE, om du anger ett kommando k√∂rs STDIO. Mismatch h√§r √§r en vanlig orsak att inget h√§nder. Windsurf kr√§ver t.ex. att SSE-URL:en **explicit inneh√•ller `/sse`** i config ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=Windsurf%20supports%20two%20transport%20types,sse)).

- **Autentisering och inputs:** MCP-protokollet i sig hanterar inte autentisering mot servern (ut√∂ver att klient och server utbyter capabilities), men milj√∂er som VS¬†Code erbjuder *‚Äúinputs‚Äù* i konfigurationen f√∂r att t.ex. fr√•ga anv√§ndaren om API-nycklar ([Extending Copilot Chat with the Model Context Protocol (MCP) - GitHub Docs](https://docs.github.com/en/copilot/customizing-copilot/extending-copilot-chat-with-mcp#:~:text=,servers%20you%20want%20to%20use)). Windsurf l√•ter dig ange milj√∂variabler i JSON-filen ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=%7B%20%22mcpServers%22%3A%20%7B%20%22google,maps%22%20%5D%2C%20%22env%22%3A)). Om din MCP-server kr√§ver en API-nyckel eller inloggning (som DataForSEO g√∂r) m√•ste detta f√∂rmedlas vid uppstart. **L√∂sning:** anv√§nd milj√∂variabler i config (s√§kert och enkelt), eller l√•t servern l√§sa fr√•n en konfigfil som anv√§ndaren sj√§lv redigerar. Undvik att h√•rdkoda hemligheter i koden. I exempelkonfigurationen f√∂r Windsurf ovan injectades `DATAFORSEO_LOGIN/PASSWORD` via `env`-f√§ltet ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=%7B%20%22mcpServers%22%3A%20%7B%20%22google,maps%22%20%5D%2C%20%22env%22%3A)). I VS¬†Code-exemplet anv√§ndes `promptString` ‚Äì vilket inneb√§r att n√§r du klickar **Start** p√• servern kommer en prompt d√§r du kan klistra in l√∂senord (detta √§r praktiskt om du vill undvika att spara det lokalt). **Sammanfattning:** Se till att servern har tillg√•ng till n√∂dv√§ndiga credentials vid runtime, annars kommer verktygsanropen f√∂rst√•s att misslyckas (t.ex. 401 Unauthorized fr√•n DataForSEO API).

- **Verktygsgr√§nssnitt (specifikation):** Din MCP-server m√•ste deklarera sina verktyg p√• ett s√§tt som klienten f√∂rst√•r. Lyckligtvis hanterar SDK:er och referensimplementationer detta automatiskt genom att skicka en **offer/manifest**-meddelande vid anslutning, som listar verktygsnamn, parametrar och beskrivningar. Om du implementerar manuellt, f√∂lj MCP-specen f√∂r `listOfferings` eller motsvarande ‚Äì klienten kommer be om verktygslistan i b√∂rjan. Codeium Cascade har noterat att de **endast st√∂djer ‚Äútools‚Äù**-primitiven, inte MCP-resurser eller prompts √§nnu ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=MCP%20tool%20calls%20will%20consume,regardless%20of%20success%20or%20failure)). S√• fokusera p√• verktyg (funktioner som exekverar och returnerar resultat). Ge verktygen unika namn och beskrivningar. Undvik att definiera grafik-/bild-utdata, eftersom vissa klienter (Cascade) inte st√∂djer bildreturer alls ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=,support%20tools%20that%20output%20images)). I praktiken, om du h√∂ll dig till text/JSON-data fr√•n DataForSEO √§r du inom ramarna.

- **Latency/prestanda-krav:** Anv√§ndaren f√∂rv√§ntar sig svar inom rimlig tid n√§r agenten k√∂r ett verktyg. Copilot Agents har en inbyggd timeout (ej offentligt dokumenterad exakt, men r√§kna med ~30 sekunder som en rimlig √∂vre gr√§ns). Windsurf/Cascade noterar att **verktygsanrop drar token-krediter oavsett om anropet lyckas eller ej** ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=,To%20reiterate)), vilket indirekt antyder att on√∂digt l√•nga eller felaktiga k√∂rningar √§r sl√∂seri. **Best Practice:** H√•ll dina verktygsfunktioner s√• snabba och effektiva som m√∂jligt. DataForSEO:s *live*-endpoints brukar ge svar inom ett par sekunder; om n√•gon beg√§ran tar v√§ldigt l√•ng tid (t.ex. tunga batch-jobb via task-post), √∂verv√§g att returnera ett meddelande om att det kommer ta tid eller g√∂r den asynkron (dock st√∂ds inte l√•nga bakgrundsjobb v√§l av nuvarande MCP-klienter utan specialhantering). Testa typiska anv√§ndningsfall och m√§t svarstider. Om latensen √§r h√∂g, kan anv√§ndaren bli ot√•lig eller tro att inget h√§nder. I SSE-l√§ge kan du skicka *progress events* (MCP har st√∂d f√∂r partial responses) men enklast √§r att optimera f√∂r snabba svar.

- **Stabilitet och felhantering:** Se till att din server hanterar fel graci√∂st. Om DataForSEO API t.ex. returnerar ett fel (felaktig parameter, ingen data, osv.), f√•nga detta och skicka ett begripligt felmeddelande tillbaka till agenten. Agenten kommer oftast bara presentera att verktyget misslyckades, men tydliga fel i JSON (t.ex. `"error": "Invalid keyword"` etc.) kan i vissa fall hj√§lpa agenten att f√∂rmedla vad som gick snett. Undvik att servern kraschar vid undantag ‚Äì en krasch bryter MCP-anslutningen. Testa ocks√• kantfall (ingen internetanslutning, fel login) f√∂r att se att servern inte h√§nger sig. 

- **S√§kerhet:** F√∂r SSE-servrar, anv√§nd HTTPS och n√•gon form av auth (√§ven om det √§r s√• enkelt som en hemlig token i en header som klienten kan s√§tta). F√∂r STDIO-servrar, var medveten om att de k√∂r med dina lokala r√§ttigheter. MCP-protokollet sj√§lvt f√∂rs√∂ker isolera verktygsk√∂rningar till definierade kommandon, men det √§r du som implementerare som ansvarar f√∂r att inte exponera farlig funktionalitet. H√•ll dig d√§rf√∂r till att enbart anropa DataForSEO och bearbeta dess svar. K√∂r inga godtyckliga skalkommandon i verktygen om det inte √§r absolut n√∂dv√§ndigt, och om du g√∂r det, dokumentera noga och √∂verv√§g s√§kerhetsimplikationerna.

## API-anrop: K√§nslighet f√∂r encoding och format

DataForSEO:s API √§r k√§nsligt f√∂r b√•de teckenkodning och format p√• de data du skickar. H√§r √§r n√•gra viktiga punkter att t√§nka p√• f√∂r att undvika vanliga problem:

### ‚úÖ R√§tt teckenkodning: Anv√§nd alltid UTF-8

All data som skickas till DataForSEO:s API m√•ste vara i **UTF-8**-format. Detta g√§ller s√§rskilt f√∂r f√§lt som `keyword` och `keywords`. Om du anv√§nder andra teckenkodningar (som ISO-8859-1 eller Windows-1252) kan det leda till att vissa tecken tolkas felaktigt eller att f√∂rfr√•gningar misslyckas.

### ‚ö†Ô∏è Undvik otill√•tna tecken i nyckelord

Vissa tecken √§r inte till√•tna i `keyword`-f√§ltet och kan orsaka fel:
- **Emojis och vissa Unicode-symboler** kan leda till fel vid inl√§mning.
- **Specialtecken** som `<`, `>`, `|`, `\\`, `"`, `-`, `+`, `=`, `~`, `!`, `:`, `*`, `(`, `)`, `[`, `]`, `{`, `}` √§r inte till√•tna i vissa endpoints.
- **Kommatecken** i nyckelord tas bort och ignoreras av API:et.

Validera dina nyckelord innan du skickar dem till API:et.

### üß± JSON-format: Strikt struktur kr√§vs

Alla POST-f√∂rfr√•gningar m√•ste ha korrekt JSON-struktur:
- **Felaktiga datatyper** (t.ex. skicka str√§ng ist√§llet f√∂r lista).
- **Saknade obligatoriska f√§lt** som `location_code` eller `language_code`.
- **Felaktig JSON-syntax** (saknade kommatecken eller felaktiga citattecken).

Anv√§nd verktyg som Postman eller JSON-validatorer.

### üß™ Tips f√∂r fels√∂kning

- **Testa med Postman**.
- **Granska API-responsen** (`status_code` och `status_message`).
- **Validera nyckelord och kontrollera UTF-8-kodning**.

Genom att f√∂lja dessa riktlinjer minskar du risken f√∂r vanliga fel.

## Vanliga problem och l√∂sningar

Trots noggranna f√∂rberedelser kan det uppst√• vanliga problem n√§r man integrerar MCP-servern med Windsurf eller Copilot Agents. H√§r √§r en lista p√• vanliga fel och hur man √•tg√§rdar dem:

- **MCP-servern syns inte eller startar inte:** Om dina verktyg inte dyker upp under *Available Tools* i IDE:n, eller om inget h√§nder n√§r du f√∂rs√∂ker anv√§nda dem, √§r f√∂rsta steget att kontrollera konfigurationen. En vanlig miss √§r fel filv√§g eller kommando. I Windsurf, se till att s√∂kv√§gen till ditt server-skript √§r korrekt ‚Äì man kan beh√∂va ange absolut s√∂kv√§g till filen ([GitHub - yeakub108/mcp-server: MCP Server for Windsurf](https://github.com/yeakub108/mcp-server#:~:text=)). I VS¬†Code, kontrollera att `.vscode/mcp.json` √§r giltig JSON (inga kommatecken fel). **L√∂sning:** Korrigera config och tryck alltid p√• **Refresh/Uppdatera** efter att du √§ndrat eller lagt till en server ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=Make%20sure%20to%20press%20the,add%20a%20new%20MCP%20server)). Vid SSE, prova √∂ppna `http://localhost:PORT/sse` i en webbl√§sare f√∂r att se om servern svarar (du b√∂r f√• en heldragen anslutning). Vid STDIO, k√∂r kommandot manuellt i terminal f√∂r att se eventuella felmeddelanden.

- **Fel: ‚ÄúFailed to connect‚Äù eller ‚ÄúSSE connection not established‚Äù:** Detta indikerar oftast transport-mismatch eller n√§tverksproblem. Exempel: Om du avser en lokal server men angav en URL i config f√∂rs√∂ker klienten SSE och misslyckas. Eller tv√§rtom, du angav ett kommando men servern f√∂rs√∂ker g√∂ra SSE-specifika handskakningar. **L√∂sning:** S√§kerst√§ll att du specificerat **r√§tt transport** i konfigurationen. F√∂r SSE, URL m√•ste peka p√• din server + `/sse`-endpoint ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=Windsurf%20supports%20two%20transport%20types,sse)), och servern m√•ste k√∂ra faktiskt SSE-server. F√∂r STDIO, anv√§nd `command`-f√§ltet och l√•t bli att ange URL. Om du k√∂r via VS¬†Code `uvx`, se till att `uv` √§r installerat (en del av Astral-verktygen f√∂r MCP). Kontrollera √§ven brandv√§gg ‚Äì om VS¬†Code f√∂rs√∂ker n√• en extern URL, m√•ste den vara √•tkomlig (ingen lokal brandv√§gg som blockerar porten).

- **Servern startar men verktyg saknas eller felaktiga:** Ibland startar servern utan problem men agenten rapporterar att verktyget inte finns n√§r du f√∂rs√∂ker anv√§nda det. Detta kan intr√§ffa om verktygsdefinitionerna inte skickats korrekt vid initiering. **L√∂sning:** Dubbelkolla att du registrerat verktygen i serverkoden. Om du anv√§nt Python SDK, se till att du anropar t.ex. `mcp.run()` eller motsvarande f√∂r att faktiskt starta lyssningen efter att ha definierat verktygen ‚Äì annars kanske scriptet avslutas innan servern k√∂rts. I Node, se till att du skickar ett **offer** (erbjudande om verktyg) initialt. Community-servrar brukar sk√∂ta detta, men om du implementerar sj√§lv, kan du beh√∂va skicka ett `{"jsonrpc":"2.0","method":"offer","params":{...}}` med verktygslistan. Anv√§nd g√§rna en befintlig implementation som mall f√∂r formatet. N√§r verktygen v√§l √§r korrekt exponerade b√∂r de synas i verktygslistan (VS¬†Code har en verktygsikon i chatten f√∂r att lista dem ([Extending Copilot Chat with the Model Context Protocol (MCP) - GitHub Docs](https://docs.github.com/en/copilot/customizing-copilot/extending-copilot-chat-with-mcp#:~:text=Image%3A%20Screenshot%20of%20the%20Copilot,is%20outlined%20in%20dark%20orange))). 

- **Milj√∂variabler saknas (authentication error):** Om du f√•r svar som tyder p√• att DataForSEO nekade anropet (t.ex. 401 Unauthorized eller liknande), eller om server-loggen klagar p√• saknat login, s√• har troligen inte API-credentials f√∂rts vidare. **L√∂sning:** Kontrollera att du satte `DATAFORSEO_LOGIN`/`PASSWORD` antingen som globala env. variabler innan du startade editorn, eller i konfigurationsfilen. I Windsurf, edita `mcp_config.json` och l√§gg till under `"env"` f√∂r servern ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=%7B%20%22mcpServers%22%3A%20%7B%20%22google,maps%22%20%5D%2C%20%22env%22%3A)). I VS Code, om du anv√§nde `promptString`, se till att du verkligen matade in r√§tt v√§rde n√§r du startade servern (du kan beh√∂va stoppa och starta om f√∂r att f√• prompten igen). Ett annat tips √§r att testa servern frist√•ende med samma milj√∂ ‚Äì k√∂r ex. `npm start` manuellt ‚Äì f√∂r att s√§kerst√§lla att den kan l√§sa variablerna i den kontext du tror. Efter fix, starta om MCP-servern.

- **Verktygsanrop fastnar eller tar f√∂r l√•ng tid:** Om agenten verkar h√§nga sig n√§r den k√∂r ett verktyg (ingen respons i chatten under l√•ng tid), kan orsaken vara att DataForSEO-anropet tar l√•ng tid eller att ett undantag inte hanteras. **L√∂sning:** Kolla serverns loggar (om du har debug-utskrifter). DataForSEO:s *standard*-metoder (task-post) levererar inte resultat direkt utan kr√§ver ett uppf√∂ljande GET ‚Äì se till att du anv√§nder *live*-endpoints f√∂r att f√• direktresultat om m√∂jligt, annars kan din funktion beh√∂va polla efter task-resultat (vilket inte √§r trivialt inom en enkel verktygsk√∂rning). F√∂r l√•nga operationer, √∂verv√§g att begr√§nsa omfattningen ‚Äì t.ex. h√§mta f√§rre resultat. Ibland kan AI-agenten ocks√• skicka orealistiskt breda f√∂rfr√•gningar (t.ex. ‚Äúh√§mta alla bak√•tl√§nkar f√∂r hela webben‚Äù) ‚Äì du kan bygga in f√∂rsvar genom att validera parametrar och returnera ett fel/f√∂rklaring i s√•dana fall, snarare √§n att f√∂rs√∂ka utf√∂ra n√•got om√∂jligt. Som en riktlinje, designa verktygen f√∂r att slutf√∂ras inom kanske **5‚Äì10 sekunder**; allt √∂ver ~30 sek riskerar timeout i agenten. 

- **Konflikter med flera MCP-servrar:** Om du har konfigurerat m√•nga MCP-servrar samtidigt kan det bli r√∂rigt. Windsurf har en gr√§ns p√• 50 verktyg totalt ([Cascade MCP Integration](https://docs.codeium.com/windsurf/mcp#:~:text=servers%20at%20one%20time%20is,limited%20to%2050)), s√• om din DataForSEO-server tillsammans med andra servrar √∂verskrider det kan den sista servern ignoreras. **L√∂sning:** Ta bort on√∂diga/duplikata servrar, eller inaktivera n√•gra verktyg (om din server har modul√§r konfiguration kan du kanske st√§nga av vissa). Generellt √§r det b√§st att b√∂rja med en server i taget. 

- **Agenten fr√•gar inte om verktyget:** I vissa fall kan AI-agenten *l√•ta bli* att anv√§nda verktyget √§ven om det vore relevant, eller inte fr√•ga om till√•telse. Detta kan vara bero p√• agentens prompt/historik. Copilot Agenten beh√∂ver ofta en hint. **L√∂sning:** Du kan explicit fr√•ga agenten i chatten: *‚ÄúKan du anv√§nda verktyget X f√∂r detta?‚Äù* eller n√§mna verktygsnamnet. I Cursor/Windsurf kan man √§ven uppdatera en `.cursorrules`-fil med hintar f√∂r n√§r verktygen ska anv√§ndas ([GitHub - yeakub108/mcp-server: MCP Server for Windsurf](https://github.com/yeakub108/mcp-server#:~:text=The%20agent%20will%20ask%20for,before%20making%20any%20tool%20calls)). Detta √§r mer av AI-styrningsproblem √§n tekniskt fel ‚Äì men v√§rt att n√§mna. Testa ge agenten tydliga uppmaningar.

Slutligen, att bygga en MCP-server med DataForSEO-integrering kan verka komplext, men genom att f√∂lja stegen ovan och vara medveten om spr√•kskillnader, hosting-alternativ och integrationens krav blir det hanterbart. Du f√•r d√• en kraftfull skr√§ddarsydd ‚ÄúSEO-assistent‚Äù direkt i din utvecklingsmilj√∂ ‚Äì som med naturligt spr√•k kan dra nytta av DataForSEO:s rika data ([DataForSEO MCP server for AI agents](https://playbooks.com/mcp/skobyn-dataforseo-seo#:~:text=This%20MCP%20server%20for%20SEO,more%20through%20natural%20language%20interactions)). Lycka till med implementationen! Skulle problem uppst√•, finns en aktiv community kring MCP (t.ex. Anthropic‚Äôs forum, GitHub-repo f√∂r MCP-servrar ([Extending Copilot Chat with the Model Context Protocol (MCP) - GitHub Docs](https://docs.github.com/en/copilot/customizing-copilot/extending-copilot-chat-with-mcp#:~:text=server%20allows%20you%20to%20use,customize%20and%20enhance%20your%20experience))) d√§r du kan f√• support och id√©er. Med tiden kan du √§ven bygga ut din MCP-server med fler verktyg eller koppla fler API:er ‚Äì m√∂jligheterna √§r stora n√§r AI-agenten kan agera √∂ver flera kommandon (d√§rav namnet Multi-Command Provider).üöÄ

